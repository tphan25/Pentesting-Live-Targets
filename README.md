# Project 8 - Pentesting Live Targets

Time spent: **5** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

Vulnerability #1: SQL Injection

GIF Walkthrough:

<img src="https://i.imgur.com/9sgB3O4.gif" alt="UH OH DIDNT LOAD">


Our first vulnerability in the blue site is SQL Injection. By manipulating the URL, we are able to inject a SQL query into the table containing user IDs. In the depicted example, I made the page sleep for 5 seconds by entering ' OR SLEEP(5)=0--'at the end of the URL (which the browser encodes some of our special characters to %27, %20) during its query.

Vulnerability #2: Session Hijacking/Fixation

GIF Walkthrough:

<img src="https://i.imgur.com/BdM3MPk.gif" alt="UHOH DIDNT LOAD LOL">


Our second vulnerability in the blue site is session hijacking/fixation. I demonstrated session hijacking. In my Firefox client on the right, I was logged in, and using the hack tool provided I retrieved the current session ID. Using this session ID and the hack tool, I changed the left side Chrome client's session ID (which was initially not logged in) to the same session ID as the Firefox client, which allowed for me to log in and hijack the Firefox client's session.


## Green

Vulnerability #1: Cross-Site Scripting (XSS)

GIF Walkthrough:

<img src="https://i.imgur.com/5Qizy85.gif" alt="UH OH DIDNT LOAD 2">


Our first vulnerability in the green site is cross site scripting. We can actually submit a feedback form containing a script in it (in this case we alert the person who views our feedback). By submitting a script in the feedback form, a user with privileges to view feedback will end up running the script when they view the feedback, which we show in the gif when we check the feedback page on our own account. The script we ran was a simple alert script, 

<script>alert('Tam found the XSS!');</script>

which can be seen near the end of the gif (after several other alerts submitted by other students).

Vulnerability #2: Username Enumeration

GIF Walkthrough:

<img src="https://i.imgur.com/0KUOmPC.gif" alt="yeet didnt load xd">


Our second vulnerability in the green site is user enumeration. While hardly noticeable for most people upon login, it appears that if a username that matches in the database of users is entered into the login field, the font stays bold for the returned message to the user. However, if a username doesn't exist in the database, the font becomes unbolded. This can be exploited by continually attempting logins and seeing if a user exists under that name, and confirming if they exist if the text is bolded. I demonstrated above using the username jmonroe99 given to us in the assignment. This issue is likely due to a change in CSS classes or different styling based on whether the user exists or not.


## Red

Vulnerability #1: Insecure Direct Object Reference (IDOR)

GIF Walkthrough:

<img src="https://i.imgur.com/iZzM4wo.gif" alt="UH OH DIDNT LOAD 3">


Our first vulnerability in the red site is insecure direct object reference. When looking at a salesperson's page, the ID of the salesperson is actually used in the URL to navigate to the page for that respective salesperson. We can manipulate the URL by changing the ID in it to another integer value, and discover hidden links such as the one found in user ID 10.

Vulnerability #2: Cross-Site Request Forgery (CSRF)

GIF Walkthrough:

<img src="https://i.imgur.com/FhDtC3B.gif" alt="YEET DIDNT LOAD HEHE">


Our second vulnerability in the red site is cross site request forgery. A form can be created that will actually POST to alter the database if an authenticated user accesses it. My form automatically submits, but is visible to the user for clarity (generally should not). To set up my gif demonstration, I hosted a local HTTP server, and while logged in as admin on the red site, I accessed my HTML page which would submit the form on load, and the form would submit a POST request to https://104.198.208.81/red/public/salesperson.php?id=1, which is a page that is meant for admins to edit salespeople. Upon sending the POST request, the data on the site with salespersons changes as a result, so if an admin or privileged user is baited into clicking the auto-submitting form, it could be potentially very dangerous to the site.


## Notes

Describe any challenges encountered while doing the work

The biggest challenge was making the form for cross site request forgery, as I needed to host the html on a local domain as well and had to install an http-server module to do so.

The challenge I found across all of these different exploits was actually finding which forms (or URL manipulation) they belonged in, and testing them across all sites.
